/*var obj = {
    "classes": [
        [1, "5а"],
        [2, "5б"],
        [3, "5в"],
        [4, "5д"],
        [5, "5р"],
        [6, "6а"],
        [7, "6б"],
        [8, "6в"],
        [9, "6г"],
        [10, "6д"],
        [11, "6р"],
        [12, "7а"],
        [13, "7б"],
        [14, "7в"],
        [15, "7г"],
        [16, "8а"],
        [17, "8б"],
        [18, "8в"],
        [19, "8г"],
        [20, "9а"],
        [21, "9б"],
        [22, "9в"],
        [23, "9г"],
        [24, "9д"],
        [25, "10а"],
        [26, "10б"],
        [27, "10в"],
        [28, "10г"],
        [29, "11а"],
        [30, "11б"],
        [31, "11в"],
        [32, "11г"]
    ],
    "days": [
        [1, "ПОНЕДІЛОК"],
        [2, "ВІВТОРОК"],
        [3, "СЕРЕДА"],
        [4, "ЧЕТВЕР"],
        [5, "П’ЯТНИЦЯ"]
    ],
    "lessons": [
        [1, 1],
        [2, 2],
        [3, 3],
        [4, 4],
        [5, 5],
        [6, 6],
        [7, 7],
        [8, 8],
        [9, 9],
        [10, 10]
    ],
    "all": [
        [1, "06.04.2020", "ПОНЕДІЛОК", "5а", 1, "10:00-10:20(:30)", "осн\".здоров.", "Вибивана Л.М.", "", "Тема: Сам надворі (5 клас. Основи здоров'я. Нова програма) | Шкільне життя   Параграф 27-читати та писати, короткий тест ст 141-142.", "https://www.schoollife.org.ua/tema-sam-nadvori-5-klas-osnovy-zdorovya-nova-prohrama/"],
        [2, "06.04.2020", "ПОНЕДІЛОК", "5а", 2, "10:40-11:00(:10)", "", "", "", "", ""],
        [3, "06.04.2020", "ПОНЕДІЛОК", "5а", 3, "11:20-11:40(:50)", "", "", "", "", ""],
        [4, "06.04.2020", "понеділок", "5а", 4, "12:00-12:20(:30)", "Укр.літ", "Толочко  І.Г.", "https://zoom.us/j/739390544?pwd=MDhZTVk5eGthdUJWL2RMWWdQUFUwQT09", "Ідентифікатор: 739 390 544    Пароль: 163613", "https://docs.google.com/document/d/175F5hMaDfG2SzMvT9FE0B96JA_1JTFNq5KiZZHovmvQ/edit"],
        [5, "06.04.2020", "ПОНЕДІЛОК", "5а", 5, "12:40-13:00(:10)", "Англ.мова І", "Ганич В.Г.", "https://us04web.zoom.us/j/5680287521?pwd=V1JQeldTdTFRRFlKc0E4Q3FSMEo2dz09", "Ідентифікатор конференції: 568 028 7521         Пароль: 597669", "https://docs.google.com/document/d/1DXIVTqV0Ni_vDVgQsdJ9ME1eWS-YrszCruSzLrGSel0/edit?usp=sharing"],
        [6, "06.04.2020", "ПОНЕДІЛОК", "5а", 5, "12:40-13:00(:10)", "Англ.моваІІ", "Сичевська О.Ю.", "", "", "https://docs.google.com/document/d/1qBK9luE31fd2oztLnbAbsWcV308kVljFG91gIzikCHo/edit?usp=sharing"],
        [7, "06.04.2020", "ПОНЕДІЛОК", "5а", 6, "13:20-13:40(:50)", "Укр.мова І", "Толочко  І.Г.", "", "", "https://docs.google.com/document/d/1Nbrd0BOP74Um40WOFQgUVU6rUH_JFEaxvvmt6vdZkjg/edit"],
        [8, "06.04.2020", "ПОНЕДІЛОК", "5а", 6, "13:20-13:40(:50)", "Укр.мова ІІ", "Гаврилюк  Н.М.", "https://us04web.zoom.us/j/5680287521?pwd=V1JQeldTdTFRRFlKc0E4Q3FSMEo2dz09", "Идентификатор конференции 568 0287521 Пароль: 597669", "https://docs.google.com/document/d/1kANkgkj5DEBA7YEFDsdmZG8941zBjh08aI1fCFLMmQE/edit"],
        [9, "06.04.2020", "ПОНЕДІЛОК", "5а", 7, "14:00-14:20(:30)", "", "", "", "", ""],
        [10, "06.04.2020", "ПОНЕДІЛОК", "5а", 8, "15:00-15:20", "", "", "", "", ""],
        [11, "06.04.2020", "ПОНЕДІЛОК", "5а", 9, "16:00-16:20", "", "", "", "", ""],
        [12, "06.04.2020", "ВІВТОРОК", "5а", 1, "10:00-10:20(:30)", "Пол.мова", "Шульженко Є.О.", "", "", "https://docs.google.com/document/d/1c_1BvY1v-0DEmz1OcxPOKJukZOUP_jYS8RX9_VFk1wM/edit?usp=sharing"],
        [13, "06.04.2020", "ВІВТОРОК", "5а", 1, "10:00-10:20(:30)", "Нім.мова", "", "", "", ""],
        [14, "06.04.2020", "ВІВТОРОК", "5а", 1, "10:00-10:20(:30)", "Фр.мова", "", "", "", ""],
        [15, "06.04.2020", "ВІВТОРОК", "5а", 2, "10:40-11:00(:10)", "укр.мова І", "", "", "", ""],
        [16, "06.04.2020", "ВІВТОРОК", "5а", 2, "10:40-11:00(:10)", "укр.мова ІІ", "", "", "", ""],
        [17, "06.04.2020", "ВІВТОРОК", "5а", 3, "11:20-11:40(:50)", "", "", "", "", ""]
    ]
};*/
/*
var obj = {};
(function() {
    var app = "https://script.google.com/macros/s/AKfycbzEUg6m39aebib5Pl6m6HG6iRqt5kXJRbG1BIZtVSy5_EAix9k/exec",
        output = {},
        xhr = new XMLHttpRequest();
    xhr.open('GET', app);
    xhr.onreadystatechange = function() {
        if (xhr.readyState !== 4) return;
        if (xhr.status == 200) {
            try {
                var output = JSON.parse(xhr.response);
            } catch (e) {}
        }
        app.all = output.all;
        console.log(app.all);
        console.log(output.all);
        app.classes = output.classes;
        app.days = output.days;
        app.lessons = output.lessons;
        app.preloaderStart = false;
        obj = output;
        console.log('log');

    }
    xhr.send()
})()*/


var app = new Vue({
    el: '#app',
    data: {
        classFilterArr: [],
        dayFilterArr: [],
        lessonsFilterArr: [],
        subjectFilterArr: [],
        changedArray: [],
        all: [],
        classes: [],
        days: [],
        lessons: [],
        editText: '',
        url: 'https://script.google.com/macros/s/AKfycbxCkbTMCe_FzyVQTxt2NTYxROMy5zCh52MILKgW6ra5wny2FLY/exec',
        filterSelect: {
            class: true,
            days: false,
            lessons: false,
            subject: false,
        },
        adminName: 'Вибивана Л.М.',
        teachers: [],
        preloaderStart: true,
        openUserStatus: false,
        adminNameSearch: '',
        showEmptyLessons: false

    },
    methods: {
        editTextChange: function(text) {
            this.editText = text;
        },
        save: function(arr) {
            console.log(arr)
            var urlSend = `${this.url}?id=${arr[0]}&teacher=${arr[7]}&href=${arr[8]}&teacherInfo=${arr[9]}&hw=${arr[10]}`;
            console.log(urlSend);
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open("GET", urlSend, true); // true for asynchronous 
            xmlHttp.send(null);
        },
        addFilter: function(varName, param) {
            if (this[varName].indexOf(param) >= 0) {
                this[varName].splice(this[varName].indexOf(param), 1)
            } else {
                this[varName].push(param);
            }
        },
        checkFilter: function(arr) {
            var out = true; // Нужно для окончательного вывода
            if (this.adminName == arr[7] || (this.showEmptyLessons ? arr[7].trim() == '' : false)) {
                out = true;
            } else {
                return false;
            }

            // проверка на пустоту масивов фильтра
            if (this.classFilterArr.length == 0 &&
                this.dayFilterArr.length == 0 &&
                this.lessonsFilterArr.length == 0 &&
                this.subjectFilterArr.length == 0) {
                return true;
            }
            // Проверка на фильтр класса
            if (this.classFilterArr.indexOf(arr[3]) >= 0 || this.classFilterArr.length == 0) {
                out = true;
            } else {
                return false;
            }
            //Проверка на фильтр дня
            if (this.dayFilterArr.indexOf(arr[2]) >= 0 || this.dayFilterArr.length == 0) {
                out = true;
            } else {
                return false;
            }
            //проверка на фильтр урока
            if (this.lessonsFilterArr.indexOf(arr[4]) >= 0 || this.lessonsFilterArr.length == 0) {
                out = true;
            } else {
                return false;
            }
            return out;
        },
        selectFilter: function(filterEl) {
            this.filterSelect.class = false;
            this.filterSelect.days = false;
            this.filterSelect.lessons = false;
            this.filterSelect.subject = false;
            this.filterSelect[filterEl] = true;
        },
        getData: function() {
            var app = "https://script.google.com/macros/s/AKfycbzEUg6m39aebib5Pl6m6HG6iRqt5kXJRbG1BIZtVSy5_EAix9k/exec",
                output = {},
                xhr = new XMLHttpRequest();
            xhr.open('GET', app);
            xhr.onreadystatechange = function() {
                if (xhr.readyState !== 4) return;
                if (xhr.status == 200) {
                    try {
                        var output = JSON.parse(xhr.response);
                    } catch (e) {}
                }
                console.log(output)
                console.log('log');
                saveData(output);
            }
            xhr.send()
        },
        selectUserStatus: function() {
            this.openUserStatus = this.openUserStatus ? false : true;
        },
        selectUser: function(name) {
            this.adminName = name;
            this.openUserStatus = false;
        },
        showEmpty: function() {
            this.showEmptyLessons = this.showEmptyLessons ? false : true;
        }
    },
    beforeMount: function() {
        this.getData();

    },
    watch: {}
})

function saveData(data) {
    app.all = data.all;
    app.classes = data.classes;
    app.days = data.days;
    app.lessons = data.lessons;
    app.teachers = data.teachers;
    app.preloaderStart = false;
}